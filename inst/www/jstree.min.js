rf=function(){function a(e,f,g){var l,h=e.length;if(h!==f.length)throw{error:"Mismatched array lengths"};if(0==h)throw{error:"At least one point required."};if(3>arguments.length)for(g=[],l=-1;++l<h;)g[l]=1;if(science_stats_rfFiniteReal(e),science_stats_rfFiniteReal(f),science_stats_rfFiniteReal(g),science_stats_rfStrictlyIncreasing(e),1==h)return[f[0]];if(2==h)return[f[0],f[1]];var m=Math.floor(b*h);if(2>m)throw{error:"Bandwidth too small."};var o=[],p=[],q=[];for(l=-1;++l<h;)o[l]=0,p[l]=0,q[l]=1;for(var r=-1;++r<=c;){var t,s=[0,m-1];for(l=-1;++l<h;){t=e[l],0<l&&science_stats_rfUpdateBandwidthInterval(e,g,l,s);for(var u=s[0],v=s[1],y=e[l]-e[u]>e[v]-e[l]?u:v,z=0,A=0,B=0,C=0,D=0,E=Math.abs(1/(e[y]-t)),F=u;F<=v;++F){var G=e[F],H=f[F],I=F<l?t-G:G-t,J=science_stats_rfTricube(I*E)*q[F]*g[F],K=G*J;z+=J,A+=K,B+=G*K,C+=H*J,D+=H*K}var L=A/z,M=C/z,N=D/z,O=B/z,P=Math.sqrt(Math.abs(O-L*L))<d?0:(N-L*M)/(O-L*L);o[l]=P*t+(M-P*L),p[l]=Math.abs(f[l]-o[l])}if(r===c)break;var R=jStat.median(p);if(Math.abs(R)<d)break;var S,J;for(l=-1;++l<h;)S=p[l]/(6*R),q[l]=1<=S?0:(J=1-S*S)*J}return o}var b=.3,c=2,d=1e-12;return a.bandwidth=function(e){return arguments.length?(b=e,a):e},a.robustnessIterations=function(e){return arguments.length?(c=e,a):e},a.accuracy=function(e){return arguments.length?(d=e,a):e},a};function science_stats_rfFiniteReal(a){for(var b=a.length,c=-1;++c<b;)if(!isFinite(a[c]))return!1;return!0}function science_stats_rfStrictlyIncreasing(a){for(var b=a.length,c=0;++c<b;)if(a[c-1]>=a[c])return!1;return!0}function science_stats_rfTricube(a){return(a=1-a*a*a)*a*a}function science_stats_rfUpdateBandwidthInterval(a,b,c,d){var e=d[0],f=d[1],g=science_stats_rfNextNonzero(b,f);if(g<a.length&&a[g]-a[c]<a[c]-a[e]){var h=science_stats_rfNextNonzero(b,e);d[0]=h,d[1]=g}}function science_stats_rfNextNonzero(a,b){for(var c=b+1;c<a.length&&0===a[c];)c++;return c}